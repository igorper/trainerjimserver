//= require jquery/dist/jquery
//= require jquery-ui/ui/jquery-ui
//= require angular/angular
//= require angular-ui-router/release/angular-ui-router
//= require angular-ui-calendar/src/calendar
//= require fullcalendar/fullcalendar
//= require fullcalendar/gcal
//= require welcome/welcome
//= require auth/auth
//= require workouts/workouts
//= require trainees/trainees
//= require results/results
//= require shared/shared
//= require angular-http-auth/src/http-auth-interceptor

angular
  .module('app', [
    'welcome',
    'workouts',
    'trainees',
    'results',
    'shared',
    'http-auth-interceptor',
    'auth'
  ])
  .controller('MainBodyCtrl', ['$rootScope', 'LoginDialog', function ($rootScope, LoginDialog) {
    $rootScope.$on('event:auth-loginRequired', function () {
      console.log("Login required!!!!");
      LoginDialog().result.then(function (credentials) {
        console.log("The dialog was closed. And got credentials:");
        console.log(credentials);
      });

    });
  }])
  .config(['$stateProvider', function ($stateProvider) {
    $stateProvider
      .state('main', {
        abstract: true,
        url: "",
        views: {
          'body': {templateUrl: '<%= asset_path('main.html') %>', controller: 'MainBodyCtrl'},
          'header': {templateUrl: '<%= asset_path('shared/header-view.html') %>'},
          'footer': {templateUrl: '<%= asset_path('shared/footer-view.html') %>'}
        }
      })
    ;
  }])
  .config(['$urlRouterProvider', function ($urlRouterProvider) {
    $urlRouterProvider.otherwise("/welcome");
  }])
;