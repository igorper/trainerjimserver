var traineeThumbModule = angular.module('trainees.traineeThumb', [
  'photos.takePhotoDialog',
  'trainees',
  'angularSpinner'
]);

traineeThumbModule.directive('traineeThumb', function () {
  return {
    restrict: 'E',
    scope: {
      'trainee': '=',
      'fillWidth': '=',
      'onTraineeClicked': '&',
      'onTraineePhotoChanged': '&',
      notClickable: '='
    },
    controller: ['$scope', 'TakePhotoDialog', 'Trainee', 'usSpinnerService', function ($scope, TakePhotoDialog, Trainee, usSpinnerService) {
      $scope.onTakePhoto = function () {
        TakePhotoDialog().result.then(function (photos) {
          usSpinnerService.spin('trainee-photo-upload-spinner');
          Trainee.setPhoto($scope.trainee, photos[0]).then(function () {
            usSpinnerService.stop('trainee-photo-upload-spinner');
            $scope.onTraineePhotoChanged();
          });
        });
      };
    }],
    templateUrl: "<%= asset_path('trainees/trainee-thumb.html') %>"
  };
});